<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml"><html><head /><body><h3> Hibernate Performance Tuning Tips </h3>
<p> Top 10 Hibernate Performance Tuning Recommendations: </p><p> • </p>  <p> • </p> <p>(1)</p> <p>Avoid join duplicates</p> (AKA cartesian products) due to joins along two or more parallel to-many associations; use Exists-subqueries, multiple queries or fetch="subselect" (see (2)) instead - whatever is most appropriate in the specific situation. Join duplicates are already pretty bad in plain SQL, but things get even worse when they occur within Hibernate, because of unnecessary mapping workload and child collections containing duplicates. •   <p>(2)</p> <p>Define lazy loading</p> as the preferred association loading strategy, and consider applying <p>fetch="batch-size" or "subselect"</p> rather than "select". Configure eager loading only for special associations, but <p>join-fetch selectively on a per-query basis</p>. •   <p>(3)</p> In case of read-only services with huge query resultsets,<p> use projections and fetch into flat DTOs</p> (e.g. via AliasToBean-ResultTransformer), instead of loading thousands of mapped objects into the Session. •   <p>(4)</p> Take advantage of <p>StatelessSessions, HQL Bulk Update and Delete</p> statements, as well as <p>Insert-By-Select</p> (supported by HQL as well). •   <p>(5)</p> Set <p>FlushMode to "Never"</p> on Queries and Criteria, when flushing is not necessary at this point. •   <p>(6)</p> Set <p>ReadOnly to "true"</p> on Queries and Criteria, when objects returned will never be modified. •   <p>(7)</p> Consider <p>clearing the whole Session after flushing, or evict on a per-object basis</p>, once objects are not longer needed. •   <p>(8)</p> Define a suitable value for <p>jdbc.batch_size</p> (resp. adonet.batch_size under NHibernate). •   <p>(9)</p> Use Hibernate <p>Query-Cache</p> and <p>Second Level Caching</p> where appropriate (but <a href="http://www.javalobby.org/java/forums/t48846.html">go sure you are aware of the consequences</a>). •   (10) Set hibernate.show_sql to "false" and ensure that Hibernate logging is running at the lowest possible loglevel (also check log4j/log4net root logger configuration). •   <p>Special Addendum: • NHibernate's 2.x ProjectionList implementation added considerable runtime-overhead, namely by invoking some reflection API calls for every resultset row. This might slow down queries with large resultsets. • As those reflection API calls were invariant in regard to the resultset rows being iterated over (as a matter of fact, what these calls actually did was to gather resultset column schema information), and I needed an immediate fix and did not have time to wait for any NHibernate patch, I forked my own ProjectionList from NHibernate's code, did all those reflection calls once, and re-used the result from that point on. Now I doubt this is still an issue under NHibernate 3.x (and I think Hibernate under Java was never affected), but if you are using NHibernate 2.x and your profiling tool shows lots of CPU cycles being burnt in ProjectionList, you might want to give this approach a try.</p> •   All those advices are Hibernate-specific. For additional database tuning tips, you may want to have a look at:    •   <p><a href="http://arnosoftwaredev.blogspot.com/2007/03/hints-and-pitfalls-in-database.html">Missing Indices</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2007/10/hints-and-pitfalls-in-database.html">The Importance Of Choosing The Right Clustered Index</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2007/06/more-performance-tuning.html">More Performance Tuning</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2010/09/sqlserver-favor-inline-udfs-over-table.html">SqlServer: Favor Inline UDFs Over Table Variables</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2010/09/sqlserver-standard-edition-does-support.html">SqlServer Standard Edition DOES Support Indexed Views</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2011/01/is-select-distinct-code-smell.html">Is "Select Distinct" a Code Smell?</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2011/10/tips-for-lightning-fast-insert.html">Tips For Lightning-Fast Insert Performance On SQL Server</a></p>   •  More Hibernate postings: <p><a href="http://arnosoftwaredev.blogspot.com/2006/12/hibernate-reverse-engineering-and.html">Hibernate Reverse Engineering And SqlServer Identity Columns</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2009/05/implementing-equals-and-hashcode-in.html">Implementing Equals And HashCode In Hibernate POCOs/POJOs</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2009/06/nhibernate-criteria-query-child.html">NHibernate Criteria-Query: Child Collection Not Populated Despite FetchMode.Join When Criteria Exists For Child Table</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2010/10/hibernate-joins-without-associations.html">Hibernate: Joins Without Associations</a></p> <p><a href="http://arnosoftwaredev.blogspot.com/2011/01/fetching-strategies-in-hibernate.html">Fetching Strategies In Hibernate</a></p>   
 <p><a href="https://www.blogger.com/share-post.g?blogID=8490763&amp;postID=276723037937029165&amp;target=email">Email This</a></p><a href="https://www.blogger.com/share-post.g?blogID=8490763&amp;postID=276723037937029165&amp;target=blog"><p>BlogThis!</p></a><a href="https://www.blogger.com/share-post.g?blogID=8490763&amp;postID=276723037937029165&amp;target=twitter"><p>Share to Twitter</p></a><a href="https://www.blogger.com/share-post.g?blogID=8490763&amp;postID=276723037937029165&amp;target=facebook"><p>Share to Facebook</p></a><a href="https://www.blogger.com/share-post.g?blogID=8490763&amp;postID=276723037937029165&amp;target=pinterest"><p>Share to Pinterest</p></a>     </body></html></html>
